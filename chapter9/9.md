<center>
    算法设计与分析第九章作业<br>
    苏亦凡&emsp;&emsp;计科12班&emsp;&emsp;200111229
</center>

## 1

根据 KMP 算法中 $\pi$ 数组的计算方法，求串 `S = 'babab'` 的 $\pi$ 数值序列。

1. $\pi[0] = 0$
2. $\pi[1]$​：`S[0] = 'b'`
   - 无前缀后缀
   - $\pi[1] = 0$
3. $\pi[2]$：`S[0,1] = 'ba'`
   - 前缀：`b`
   - 后缀：`a`
   - $\to\pi[2] = 0$
4. $\pi[3]$​：`S[0,1,2] = 'bab'`
   - 前缀：`b`, `ba`
   - 后缀：`b`, `ab`
   - $\to\pi[3] = 1$
5. $\pi[4]$：`S[0,1,2,3] = 'baba'`
   - 前缀：`b`, `ba`, `bab`
   - 后缀：`a`, `ba`, `aba`
   - $\to\pi[4] = 1$
6. $\pi[5]$​：`S[0,1,2,3,4] = 'babab'`
   - 前缀：`b`, `ba`, `bab`, `baba`
   - 后缀：`b`, `ab`, `bab`, `abab`
   - $\to\pi[5] = 2$

|   $q$    |   0   |   1   |   2   |   3   |   4   |   5   |
| :------: | :---: | :---: | :---: | :---: | :---: | :---: |
| $\pi[q]$ |   0   |   0   |   0   |   1   |   1   |   2   |

## 2

1. 写出 BMH 算法的偏移表计算公式。

2. 如下表格是 BMH 算法的匹配过程，请写出第 $2$ 到 $5$ 行的内容。
<div STYLE="page-break-after: always;"></div>

|   i   |   0   |   1   |             2              |   3   |   4   |   5   |   6   |   7   |   8   |   9   |  10   |  11   |  12   |  13   |  14   |  15   |  16   |  17   |
| :---: | :---: | :---: | :------------------------: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: |
|   T   |   a   |   b   |             d              |   a   |   c   |   b   |   a   |   c   |   d   |   b   |   c   |   a   |   c   |   a   |   b   |   c   |   a   |   c   |
|   1   |   a   |   b   | <font color='red'>c</font> |   a   |   c   |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |
|   2   |  $~$  |  $~$  |            $~$             |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |
|   3   |  $~$  |  $~$  |            $~$             |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |
|   4   |  $~$  |  $~$  |            $~$             |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |
|   5   |  $~$  |  $~$  |            $~$             |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |
|   6   |  $~$  |  $~$  |            $~$             |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |
|   7   |  $~$  |  $~$  |            $~$             |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |   a   |   b   |   c   |   a   |   c   |

答：
1. 偏移表计算公式为：
$$
\mathrm{shift}[w] = \begin{cases}
m - 1 - max\{i < m - 1 | P[i] = w\} &, w \in P[0 \cdots m - 2] \\
m &,其他
\end{cases}
$$

2. 

|   i   |   0   |   1   |             2              |   3   |   4   |             5              |             6              |   7   |   8   |   9   |             10             |             11             |  12   |  13   |  14   |  15   |  16   |  17   |
| :---: | :---: | :---: | :------------------------: | :---: | :---: | :------------------------: | :------------------------: | :---: | :---: | :---: | :------------------------: | :------------------------: | :---: | :---: | :---: | :---: | :---: | :---: |
|   T   |   a   |   b   |             d              |   a   |   c   |             b              |             a              |   c   |   d   |   b   |             c              |             a              |   c   |   a   |   b   |   c   |   a   |   c   |
|   1   |   a   |   b   | <font color='red'>c</font> |   a   |   c   |            $~$             |            $~$             |  $~$  |  $~$  |  $~$  |            $~$             |            $~$             |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |
|   2   |  $~$  |  $~$  |             a              |   b   |   c   | <font color='red'>a</font> |             c              |  $~$  |  $~$  |  $~$  |            $~$             |            $~$             |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |
|   3   |  $~$  |  $~$  |            $~$             |   a   |   b   | <font color='red'>c</font> |             a              |   c   |  $~$  |  $~$  |            $~$             |            $~$             |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |
|   4   |  $~$  |  $~$  |            $~$             |  $~$  |  $~$  |             a              | <font color='red'>b</font> |   c   |   a   |   c   |            $~$             |            $~$             |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |
|   5   |  $~$  |  $~$  |            $~$             |  $~$  |  $~$  |            $~$             |            $~$             |  $~$  |   a   |   b   | <font color='red'>c</font> |             a              |   c   |  $~$  |  $~$  |  $~$  |  $~$  |  $~$  |
|   6   |  $~$  |  $~$  |            $~$             |  $~$  |  $~$  |            $~$             |            $~$             |  $~$  |  $~$  |  $~$  |             a              | <font color='red'>b</font> |   c   |   a   |   c   |  $~$  |  $~$  |  $~$  |
|   7   |  $~$  |  $~$  |            $~$             |  $~$  |  $~$  |            $~$             |            $~$             |  $~$  |  $~$  |  $~$  |            $~$             |            $~$             |  $~$  |   a   |   b   |   c   |   a   |   c   |